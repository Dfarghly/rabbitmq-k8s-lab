# ------------------------------------------------------------
# grafana-api-ingress-example.yaml
# ------------------------------------------------------------
# Example Ingress for exposing the Grafana HTTP API/UI via ingress-nginx.
#
# SAFE FOR PUBLIC USE â€” real domains and certificate names have been
# replaced with placeholders.
#
# ------------------------------------------------------------
# ðŸ“Œ HOW TO USE IN YOUR LAB
# ------------------------------------------------------------
#
# 1. Make sure ingress-nginx is installed and running:
#      kubectl get pods -n ingress-nginx
#
# 2. Make sure the Grafana Service exists (example: "grafana2", port 80)
#      kubectl get svc -n <GRAFANA_NAMESPACE>
#
# 3. Replace placeholders:
#      - <GRAFANA_NAMESPACE>  â†’ namespace where Grafana Service lives
#      - <GRAFANA_SERVICE>    â†’ Service name (e.g. grafana, grafana2)
#      - <GRAFANA_HOST>       â†’ domain you will point DNS to (e.g. grafana.lab.local)
#      - <TLS_SECRET_NAME>    â†’ TLS secret containing your cert
#
# 4. Apply:
#      kubectl apply -f grafana-api-ingress-example.yaml
#
# 5. Verify:
#      kubectl get ingress -n <GRAFANA_NAMESPACE>
#
# ------------------------------------------------------------

apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: grafana-api-ingress
  namespace: <GRAFANA_NAMESPACE>          # e.g. monitoring
  annotations:
    kubernetes.io/ingress.class: nginx
    nginx.ingress.kubernetes.io/rewrite-target: /
spec:
  rules:
    - host: <GRAFANA_HOST>               # e.g. grafana.lab.example.com
      http:
        paths:
          - path: /
            pathType: ImplementationSpecific
            backend:
              service:
                name: <GRAFANA_SERVICE>  # e.g. grafana2
                port:
                  number: 80

  tls:
    - hosts:
        - <GRAFANA_HOST>
      secretName: <TLS_SECRET_NAME>      # e.g. grafana-tls
